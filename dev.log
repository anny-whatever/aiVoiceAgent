anny@Anny:~/Project/aiVoiceAgent/backend$ npm run dev

> backend@1.0.0 dev
> tsx watch src/server.ts

‚úÖ Driving data loaded
üöÄ Drival server running on http://localhost:3001
‚úÖ WebSocket monitor initialized
‚úÖ Database schema updated successfully
‚úÖ SQLite usage database initialized
‚úÖ Usage service initialized
‚úÖ Usage service initialized
üì° WebSocket monitor connection established
üì° Session session_1756313976117_0vtj4dn5p connected to monitor
üîî Client heartbeat received: {
  timestamp: 1756313978220,
  sessionToken: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiJ1c2VyMSIsInNlc3Npb25JZCI6InNlc3Npb25fMTc1NjMxMzk3NjExN18wdnRqNGRuNXAiLCJxdW90YVNlY29uZHMiOjkwMCwiaXNzdWVkQXQiOjE3NTYzMTM5NzYxMTcsImV4cGlyZXNBdCI6MTc1NjMxNDg3NjExNywiaXBBZGRyZXNzIjoiOjpmZmZmOjEyNy4wLjAuMSIsIm5vbmNlIjoiNmNlY2M5MDZkYTRjNWMwZjU5OTE5NjU4OTliYThlZjYiLCJpYXQiOjE3NTYzMTM5NzYsImV4cCI6MTc1NjMxNDg3NiwiYXVkIjoicmVhbHRpbWUtc2Vzc2lvbiIsImlzcyI6ImFpVm9pY2VBZ2VudCJ9.xaH7RvqdekrpLkDB7354Y8Ri7TjYyXIzrrybuhVT-Ys'
}
üíì Processing heartbeat for session: session_1756313976117_0vtj4dn5p incremental time: 1 seconds, total used: 1 seconds
üìù Updating active session: session_1756313976117_0vtj4dn5p with: { lastHeartbeat: '2025-08-27T16:59:38.104Z', quotaUsed: 1 }
‚úÖ Active session updated in database
üìù Updating active session: session_1756313976117_0vtj4dn5p with: { lastHeartbeat: '2025-08-27T16:59:38.119Z', quotaUsed: 1 }
‚úÖ Active session updated in database
üíæ Updating user usage: {
  userId: 'user1',
  month: '2025-08',
  totalSeconds: 0,
  sessionsCount: 0,
  lastReset: '2025-08-27T16:55:33.499Z',
  sessionTimeRemaining: 899
}
‚úÖ User usage updated in database
üíæ Updating user usage: {
  userId: 'user1',
  month: '2025-08',
  totalSeconds: 0,
  sessionsCount: 0,
  lastReset: '2025-08-27T16:55:33.499Z',
  sessionTimeRemaining: 899
}
‚úÖ User usage updated in database
Tool usage: POST /tools/assess_user_mood - Session: session_1756313976117_0vtj4dn5p - User: user1
üß† Mood assessment tool called: {
  userId: 'user1',
  userResponse: "Hello! I'm Alex Johnson and I'm ready to chat with my driving assistant. My preferred language is English. Please greet me by name in English and ask specifically about how I'm feeling or my mood today in English.",
  sessionId: 'session-1756313980856-user1'
}
üß† AI Assessing mood for user user1: "Hello! I'm Alex Johnson and I'm ready to chat with my driving assistant. My preferred language is En..."
üîî Client heartbeat received: {
  timestamp: 1756313983220,
  sessionToken: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiJ1c2VyMSIsInNlc3Npb25JZCI6InNlc3Npb25fMTc1NjMxMzk3NjExN18wdnRqNGRuNXAiLCJxdW90YVNlY29uZHMiOjkwMCwiaXNzdWVkQXQiOjE3NTYzMTM5NzYxMTcsImV4cGlyZXNBdCI6MTc1NjMxNDg3NjExNywiaXBBZGRyZXNzIjoiOjpmZmZmOjEyNy4wLjAuMSIsIm5vbmNlIjoiNmNlY2M5MDZkYTRjNWMwZjU5OTE5NjU4OTliYThlZjYiLCJpYXQiOjE3NTYzMTM5NzYsImV4cCI6MTc1NjMxNDg3NiwiYXVkIjoicmVhbHRpbWUtc2Vzc2lvbiIsImlzcyI6ImFpVm9pY2VBZ2VudCJ9.xaH7RvqdekrpLkDB7354Y8Ri7TjYyXIzrrybuhVT-Ys'
}
üíì Processing heartbeat for session: session_1756313976117_0vtj4dn5p incremental time: 4 seconds, total used: 5 seconds
üìù Updating active session: session_1756313976117_0vtj4dn5p with: { lastHeartbeat: '2025-08-27T16:59:42.993Z', quotaUsed: 5 }
‚úÖ Active session updated in database
üìù Updating active session: session_1756313976117_0vtj4dn5p with: { lastHeartbeat: '2025-08-27T16:59:43.006Z', quotaUsed: 5 }
‚úÖ Active session updated in database
üíæ Updating user usage: {
  userId: 'user1',
  month: '2025-08',
  totalSeconds: 0,
  sessionsCount: 0,
  lastReset: '2025-08-27T16:55:33.499Z',
  sessionTimeRemaining: 894
}
‚úÖ User usage updated in database
üíæ Updating user usage: {
  userId: 'user1',
  month: '2025-08',
  totalSeconds: 0,
  sessionsCount: 0,
  lastReset: '2025-08-27T16:55:33.499Z',
  sessionTimeRemaining: 894
}
‚úÖ User usage updated in database
üìù Session updated for user1 with mood: excited
‚úÖ AI Mood assessed: excited (confidence: 0.80) - The user starts with a cheerful greeting and introduces themselves with enthusiasm, indicating a positive energy level. The request for a personalized greeting and inquiry about their mood suggests eagerness to engage in conversation, reflecting an excited emotional state.
‚úÖ Mood assessed: excited | Confidence: 0.80
üîî Client heartbeat received: {
  timestamp: 1756313988223,
  sessionToken: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiJ1c2VyMSIsInNlc3Npb25JZCI6InNlc3Npb25fMTc1NjMxMzk3NjExN18wdnRqNGRuNXAiLCJxdW90YVNlY29uZHMiOjkwMCwiaXNzdWVkQXQiOjE3NTYzMTM5NzYxMTcsImV4cGlyZXNBdCI6MTc1NjMxNDg3NjExNywiaXBBZGRyZXNzIjoiOjpmZmZmOjEyNy4wLjAuMSIsIm5vbmNlIjoiNmNlY2M5MDZkYTRjNWMwZjU5OTE5NjU4OTliYThlZjYiLCJpYXQiOjE3NTYzMTM5NzYsImV4cCI6MTc1NjMxNDg3NiwiYXVkIjoicmVhbHRpbWUtc2Vzc2lvbiIsImlzcyI6ImFpVm9pY2VBZ2VudCJ9.xaH7RvqdekrpLkDB7354Y8Ri7TjYyXIzrrybuhVT-Ys'
}
üíì Processing heartbeat for session: session_1756313976117_0vtj4dn5p incremental time: 5 seconds, total used: 10 seconds
üìù Updating active session: session_1756313976117_0vtj4dn5p with: { lastHeartbeat: '2025-08-27T16:59:48.608Z', quotaUsed: 10 }
‚úÖ Active session updated in database
üìù Updating active session: session_1756313976117_0vtj4dn5p with: { lastHeartbeat: '2025-08-27T16:59:48.623Z', quotaUsed: 10 }
‚úÖ Active session updated in database
üíæ Updating user usage: {
  userId: 'user1',
  month: '2025-08',
  totalSeconds: 0,
  sessionsCount: 0,
  lastReset: '2025-08-27T16:55:33.499Z',
  sessionTimeRemaining: 884
}
‚úÖ User usage updated in database
üíæ Updating user usage: {
  userId: 'user1',
  month: '2025-08',
  totalSeconds: 0,
  sessionsCount: 0,
  lastReset: '2025-08-27T16:55:33.499Z',
  sessionTimeRemaining: 884
}
‚úÖ User usage updated in database
Tool usage: POST /tools/assess_user_mood - Session: session_1756313976117_0vtj4dn5p - User: user1
üß† Mood assessment tool called: {
  userId: 'user1',
  userResponse: 'I am feeling fine. What about you?',
  sessionId: 'session-1756313991207-user1'
}
üß† AI Assessing mood for user user1: "I am feeling fine. What about you?..."
üìù Session updated for user1 with mood: content
‚úÖ AI Mood assessed: content (confidence: 0.80) - The phrase 'I am feeling fine' indicates a sense of satisfaction and balance, suggesting a stable emotional state. The follow-up question 'What about you?' shows engagement and interest in the other person's feelings, which adds to the overall positive tone.
‚úÖ Mood assessed: content | Confidence: 0.80
üîî Client heartbeat received: {
  timestamp: 1756313993221,
  sessionToken: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiJ1c2VyMSIsInNlc3Npb25JZCI6InNlc3Npb25fMTc1NjMxMzk3NjExN18wdnRqNGRuNXAiLCJxdW90YVNlY29uZHMiOjkwMCwiaXNzdWVkQXQiOjE3NTYzMTM5NzYxMTcsImV4cGlyZXNBdCI6MTc1NjMxNDg3NjExNywiaXBBZGRyZXNzIjoiOjpmZmZmOjEyNy4wLjAuMSIsIm5vbmNlIjoiNmNlY2M5MDZkYTRjNWMwZjU5OTE5NjU4OTliYThlZjYiLCJpYXQiOjE3NTYzMTM5NzYsImV4cCI6MTc1NjMxNDg3NiwiYXVkIjoicmVhbHRpbWUtc2Vzc2lvbiIsImlzcyI6ImFpVm9pY2VBZ2VudCJ9.xaH7RvqdekrpLkDB7354Y8Ri7TjYyXIzrrybuhVT-Ys'
}
üíì Processing heartbeat for session: session_1756313976117_0vtj4dn5p incremental time: 4 seconds, total used: 14 seconds
üìù Updating active session: session_1756313976117_0vtj4dn5p with: { lastHeartbeat: '2025-08-27T16:59:53.495Z', quotaUsed: 14 }
‚úÖ Active session updated in database
üìù Updating active session: session_1756313976117_0vtj4dn5p with: { lastHeartbeat: '2025-08-27T16:59:53.509Z', quotaUsed: 14 }
‚úÖ Active session updated in database
üíæ Updating user usage: {
  userId: 'user1',
  month: '2025-08',
  totalSeconds: 0,
  sessionsCount: 0,
  lastReset: '2025-08-27T16:55:33.499Z',
  sessionTimeRemaining: 870
}
‚úÖ User usage updated in database
üíæ Updating user usage: {
  userId: 'user1',
  month: '2025-08',
  totalSeconds: 0,
  sessionsCount: 0,
  lastReset: '2025-08-27T16:55:33.499Z',
  sessionTimeRemaining: 870
}
‚úÖ User usage updated in database
üîî Client heartbeat received: {
  timestamp: 1756313998222,
  sessionToken: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiJ1c2VyMSIsInNlc3Npb25JZCI6InNlc3Npb25fMTc1NjMxMzk3NjExN18wdnRqNGRuNXAiLCJxdW90YVNlY29uZHMiOjkwMCwiaXNzdWVkQXQiOjE3NTYzMTM5NzYxMTcsImV4cGlyZXNBdCI6MTc1NjMxNDg3NjExNywiaXBBZGRyZXNzIjoiOjpmZmZmOjEyNy4wLjAuMSIsIm5vbmNlIjoiNmNlY2M5MDZkYTRjNWMwZjU5OTE5NjU4OTliYThlZjYiLCJpYXQiOjE3NTYzMTM5NzYsImV4cCI6MTc1NjMxNDg3NiwiYXVkIjoicmVhbHRpbWUtc2Vzc2lvbiIsImlzcyI6ImFpVm9pY2VBZ2VudCJ9.xaH7RvqdekrpLkDB7354Y8Ri7TjYyXIzrrybuhVT-Ys'
}
üíì Processing heartbeat for session: session_1756313976117_0vtj4dn5p incremental time: 4 seconds, total used: 18 seconds
üìù Updating active session: session_1756313976117_0vtj4dn5p with: { lastHeartbeat: '2025-08-27T16:59:58.391Z', quotaUsed: 18 }
‚úÖ Active session updated in database
üìù Updating active session: session_1756313976117_0vtj4dn5p with: { lastHeartbeat: '2025-08-27T16:59:58.405Z', quotaUsed: 18 }
‚úÖ Active session updated in database
üíæ Updating user usage: {
  userId: 'user1',
  month: '2025-08',
  totalSeconds: 0,
  sessionsCount: 0,
  lastReset: '2025-08-27T16:55:33.499Z',
  sessionTimeRemaining: 852
}
‚úÖ User usage updated in database
üíæ Updating user usage: {
  userId: 'user1',
  month: '2025-08',
  totalSeconds: 0,
  sessionsCount: 0,
  lastReset: '2025-08-27T16:55:33.499Z',
  sessionTimeRemaining: 852
}
‚úÖ User usage updated in database
üîî Client heartbeat received: {
  timestamp: 1756314003221,
  sessionToken: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiJ1c2VyMSIsInNlc3Npb25JZCI6InNlc3Npb25fMTc1NjMxMzk3NjExN18wdnRqNGRuNXAiLCJxdW90YVNlY29uZHMiOjkwMCwiaXNzdWVkQXQiOjE3NTYzMTM5NzYxMTcsImV4cGlyZXNBdCI6MTc1NjMxNDg3NjExNywiaXBBZGRyZXNzIjoiOjpmZmZmOjEyNy4wLjAuMSIsIm5vbmNlIjoiNmNlY2M5MDZkYTRjNWMwZjU5OTE5NjU4OTliYThlZjYiLCJpYXQiOjE3NTYzMTM5NzYsImV4cCI6MTc1NjMxNDg3NiwiYXVkIjoicmVhbHRpbWUtc2Vzc2lvbiIsImlzcyI6ImFpVm9pY2VBZ2VudCJ9.xaH7RvqdekrpLkDB7354Y8Ri7TjYyXIzrrybuhVT-Ys'
}
üíì Processing heartbeat for session: session_1756313976117_0vtj4dn5p incremental time: 4 seconds, total used: 22 seconds
üìù Updating active session: session_1756313976117_0vtj4dn5p with: { lastHeartbeat: '2025-08-27T17:00:03.279Z', quotaUsed: 22 }
‚úÖ Active session updated in database
üìù Updating active session: session_1756313976117_0vtj4dn5p with: { lastHeartbeat: '2025-08-27T17:00:03.293Z', quotaUsed: 22 }
‚úÖ Active session updated in database
üíæ Updating user usage: {
  userId: 'user1',
  month: '2025-08',
  totalSeconds: 0,
  sessionsCount: 0,
  lastReset: '2025-08-27T16:55:33.499Z',
  sessionTimeRemaining: 830
}
‚úÖ User usage updated in database
üíæ Updating user usage: {
  userId: 'user1',
  month: '2025-08',
  totalSeconds: 0,
  sessionsCount: 0,
  lastReset: '2025-08-27T16:55:33.499Z',
  sessionTimeRemaining: 830
}
‚úÖ User usage updated in database
üîî Client heartbeat received: {
  timestamp: 1756314008220,
  sessionToken: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiJ1c2VyMSIsInNlc3Npb25JZCI6InNlc3Npb25fMTc1NjMxMzk3NjExN18wdnRqNGRuNXAiLCJxdW90YVNlY29uZHMiOjkwMCwiaXNzdWVkQXQiOjE3NTYzMTM5NzYxMTcsImV4cGlyZXNBdCI6MTc1NjMxNDg3NjExNywiaXBBZGRyZXNzIjoiOjpmZmZmOjEyNy4wLjAuMSIsIm5vbmNlIjoiNmNlY2M5MDZkYTRjNWMwZjU5OTE5NjU4OTliYThlZjYiLCJpYXQiOjE3NTYzMTM5NzYsImV4cCI6MTc1NjMxNDg3NiwiYXVkIjoicmVhbHRpbWUtc2Vzc2lvbiIsImlzcyI6ImFpVm9pY2VBZ2VudCJ9.xaH7RvqdekrpLkDB7354Y8Ri7TjYyXIzrrybuhVT-Ys'
}
üíì Processing heartbeat for session: session_1756313976117_0vtj4dn5p incremental time: 4 seconds, total used: 26 seconds
üìù Updating active session: session_1756313976117_0vtj4dn5p with: { lastHeartbeat: '2025-08-27T17:00:08.169Z', quotaUsed: 26 }
‚úÖ Active session updated in database
üìù Updating active session: session_1756313976117_0vtj4dn5p with: { lastHeartbeat: '2025-08-27T17:00:08.183Z', quotaUsed: 26 }
‚úÖ Active session updated in database
üíæ Updating user usage: {
  userId: 'user1',
  month: '2025-08',
  totalSeconds: 0,
  sessionsCount: 0,
  lastReset: '2025-08-27T16:55:33.499Z',
  sessionTimeRemaining: 804
}
‚úÖ User usage updated in database
üíæ Updating user usage: {
  userId: 'user1',
  month: '2025-08',
  totalSeconds: 0,
  sessionsCount: 0,
  lastReset: '2025-08-27T16:55:33.499Z',
  sessionTimeRemaining: 804
}
‚úÖ User usage updated in database
Tool usage: POST /tools/assess_user_mood - Session: session_1756313976117_0vtj4dn5p - User: user1
üß† Mood assessment tool called: {
  userId: 'user1',
  userResponse: 'Yeah... no, actually not at all.',
  sessionId: 'session-1756314009511-user1'
}
üß† AI Assessing mood for user user1: "Yeah... no, actually not at all...."
üìù Session updated for user1 with mood: frustrated
‚úÖ AI Mood assessed: frustrated (confidence: 0.80) - The use of 'Yeah... no' suggests a conflicted or dismissive attitude, indicating irritation or frustration. The phrase 'actually not at all' reinforces a sense of rejection or disappointment, implying that the user is not satisfied with the situation.
‚úÖ Mood assessed: frustrated | Confidence: 0.80
