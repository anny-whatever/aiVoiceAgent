anny@Anny:~/Project/aiVoiceAgent/backend$ npm run dev

> backend@1.0.0 dev
> tsx watch src/server.ts

âœ… Driving data loaded
ğŸš€ Drival server running on http://localhost:3001
âœ… WebSocket monitor initialized
âœ… Database schema updated successfully
âœ… SQLite usage database initialized
âœ… Usage service initialized
âœ… Usage service initialized
ğŸ“¡ WebSocket monitor connection established
ğŸ“¡ Session session_1756313976117_0vtj4dn5p connected to monitor
ğŸ”” Client heartbeat received: {
  timestamp: 1756313978220,
  sessionToken: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiJ1c2VyMSIsInNlc3Npb25JZCI6InNlc3Npb25fMTc1NjMxMzk3NjExN18wdnRqNGRuNXAiLCJxdW90YVNlY29uZHMiOjkwMCwiaXNzdWVkQXQiOjE3NTYzMTM5NzYxMTcsImV4cGlyZXNBdCI6MTc1NjMxNDg3NjExNywiaXBBZGRyZXNzIjoiOjpmZmZmOjEyNy4wLjAuMSIsIm5vbmNlIjoiNmNlY2M5MDZkYTRjNWMwZjU5OTE5NjU4OTliYThlZjYiLCJpYXQiOjE3NTYzMTM5NzYsImV4cCI6MTc1NjMxNDg3NiwiYXVkIjoicmVhbHRpbWUtc2Vzc2lvbiIsImlzcyI6ImFpVm9pY2VBZ2VudCJ9.xaH7RvqdekrpLkDB7354Y8Ri7TjYyXIzrrybuhVT-Ys'
}
ğŸ’“ Processing heartbeat for session: session_1756313976117_0vtj4dn5p incremental time: 1 seconds, total used: 1 seconds
ğŸ“ Updating active session: session_1756313976117_0vtj4dn5p with: { lastHeartbeat: '2025-08-27T16:59:38.104Z', quotaUsed: 1 }
âœ… Active session updated in database
ğŸ“ Updating active session: session_1756313976117_0vtj4dn5p with: { lastHeartbeat: '2025-08-27T16:59:38.119Z', quotaUsed: 1 }
âœ… Active session updated in database
ğŸ’¾ Updating user usage: {
  userId: 'user1',
  month: '2025-08',
  totalSeconds: 0,
  sessionsCount: 0,
  lastReset: '2025-08-27T16:55:33.499Z',
  sessionTimeRemaining: 899
}
âœ… User usage updated in database
ğŸ’¾ Updating user usage: {
  userId: 'user1',
  month: '2025-08',
  totalSeconds: 0,
  sessionsCount: 0,
  lastReset: '2025-08-27T16:55:33.499Z',
  sessionTimeRemaining: 899
}
âœ… User usage updated in database
Tool usage: POST /tools/assess_user_mood - Session: session_1756313976117_0vtj4dn5p - User: user1
ğŸ§  Mood assessment tool called: {
  userId: 'user1',
  userResponse: "Hello! I'm Alex Johnson and I'm ready to chat with my driving assistant. My preferred language is English. Please greet me by name in English and ask specifically about how I'm feeling or my mood today in English.",
  sessionId: 'session-1756313980856-user1'
}
ğŸ§  AI Assessing mood for user user1: "Hello! I'm Alex Johnson and I'm ready to chat with my driving assistant. My preferred language is En..."
ğŸ”” Client heartbeat received: {
  timestamp: 1756313983220,
  sessionToken: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiJ1c2VyMSIsInNlc3Npb25JZCI6InNlc3Npb25fMTc1NjMxMzk3NjExN18wdnRqNGRuNXAiLCJxdW90YVNlY29uZHMiOjkwMCwiaXNzdWVkQXQiOjE3NTYzMTM5NzYxMTcsImV4cGlyZXNBdCI6MTc1NjMxNDg3NjExNywiaXBBZGRyZXNzIjoiOjpmZmZmOjEyNy4wLjAuMSIsIm5vbmNlIjoiNmNlY2M5MDZkYTRjNWMwZjU5OTE5NjU4OTliYThlZjYiLCJpYXQiOjE3NTYzMTM5NzYsImV4cCI6MTc1NjMxNDg3NiwiYXVkIjoicmVhbHRpbWUtc2Vzc2lvbiIsImlzcyI6ImFpVm9pY2VBZ2VudCJ9.xaH7RvqdekrpLkDB7354Y8Ri7TjYyXIzrrybuhVT-Ys'
}
ğŸ’“ Processing heartbeat for session: session_1756313976117_0vtj4dn5p incremental time: 4 seconds, total used: 5 seconds
ğŸ“ Updating active session: session_1756313976117_0vtj4dn5p with: { lastHeartbeat: '2025-08-27T16:59:42.993Z', quotaUsed: 5 }
âœ… Active session updated in database
ğŸ“ Updating active session: session_1756313976117_0vtj4dn5p with: { lastHeartbeat: '2025-08-27T16:59:43.006Z', quotaUsed: 5 }
âœ… Active session updated in database
ğŸ’¾ Updating user usage: {
  userId: 'user1',
  month: '2025-08',
  totalSeconds: 0,
  sessionsCount: 0,
  lastReset: '2025-08-27T16:55:33.499Z',
  sessionTimeRemaining: 894
}
âœ… User usage updated in database
ğŸ’¾ Updating user usage: {
  userId: 'user1',
  month: '2025-08',
  totalSeconds: 0,
  sessionsCount: 0,
  lastReset: '2025-08-27T16:55:33.499Z',
  sessionTimeRemaining: 894
}
âœ… User usage updated in database
ğŸ“ Session updated for user1 with mood: excited
âœ… AI Mood assessed: excited (confidence: 0.80) - The user starts with a cheerful greeting and introduces themselves with enthusiasm, indicating a positive energy level. The request for a personalized greeting and inquiry about their mood suggests eagerness to engage in conversation, reflecting an excited emotional state.
âœ… Mood assessed: excited | Confidence: 0.80
ğŸ”” Client heartbeat received: {
  timestamp: 1756313988223,
  sessionToken: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiJ1c2VyMSIsInNlc3Npb25JZCI6InNlc3Npb25fMTc1NjMxMzk3NjExN18wdnRqNGRuNXAiLCJxdW90YVNlY29uZHMiOjkwMCwiaXNzdWVkQXQiOjE3NTYzMTM5NzYxMTcsImV4cGlyZXNBdCI6MTc1NjMxNDg3NjExNywiaXBBZGRyZXNzIjoiOjpmZmZmOjEyNy4wLjAuMSIsIm5vbmNlIjoiNmNlY2M5MDZkYTRjNWMwZjU5OTE5NjU4OTliYThlZjYiLCJpYXQiOjE3NTYzMTM5NzYsImV4cCI6MTc1NjMxNDg3NiwiYXVkIjoicmVhbHRpbWUtc2Vzc2lvbiIsImlzcyI6ImFpVm9pY2VBZ2VudCJ9.xaH7RvqdekrpLkDB7354Y8Ri7TjYyXIzrrybuhVT-Ys'
}
ğŸ’“ Processing heartbeat for session: session_1756313976117_0vtj4dn5p incremental time: 5 seconds, total used: 10 seconds
ğŸ“ Updating active session: session_1756313976117_0vtj4dn5p with: { lastHeartbeat: '2025-08-27T16:59:48.608Z', quotaUsed: 10 }
âœ… Active session updated in database
ğŸ“ Updating active session: session_1756313976117_0vtj4dn5p with: { lastHeartbeat: '2025-08-27T16:59:48.623Z', quotaUsed: 10 }
âœ… Active session updated in database
ğŸ’¾ Updating user usage: {
  userId: 'user1',
  month: '2025-08',
  totalSeconds: 0,
  sessionsCount: 0,
  lastReset: '2025-08-27T16:55:33.499Z',
  sessionTimeRemaining: 884
}
âœ… User usage updated in database
ğŸ’¾ Updating user usage: {
  userId: 'user1',
  month: '2025-08',
  totalSeconds: 0,
  sessionsCount: 0,
  lastReset: '2025-08-27T16:55:33.499Z',
  sessionTimeRemaining: 884
}
âœ… User usage updated in database
Tool usage: POST /tools/assess_user_mood - Session: session_1756313976117_0vtj4dn5p - User: user1
ğŸ§  Mood assessment tool called: {
  userId: 'user1',
  userResponse: 'I am feeling fine. What about you?',
  sessionId: 'session-1756313991207-user1'
}
ğŸ§  AI Assessing mood for user user1: "I am feeling fine. What about you?..."
ğŸ“ Session updated for user1 with mood: content
âœ… AI Mood assessed: content (confidence: 0.80) - The phrase 'I am feeling fine' indicates a sense of satisfaction and balance, suggesting a stable emotional state. The follow-up question 'What about you?' shows engagement and interest in the other person's feelings, which adds to the overall positive tone.
âœ… Mood assessed: content | Confidence: 0.80
ğŸ”” Client heartbeat received: {
  timestamp: 1756313993221,
  sessionToken: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiJ1c2VyMSIsInNlc3Npb25JZCI6InNlc3Npb25fMTc1NjMxMzk3NjExN18wdnRqNGRuNXAiLCJxdW90YVNlY29uZHMiOjkwMCwiaXNzdWVkQXQiOjE3NTYzMTM5NzYxMTcsImV4cGlyZXNBdCI6MTc1NjMxNDg3NjExNywiaXBBZGRyZXNzIjoiOjpmZmZmOjEyNy4wLjAuMSIsIm5vbmNlIjoiNmNlY2M5MDZkYTRjNWMwZjU5OTE5NjU4OTliYThlZjYiLCJpYXQiOjE3NTYzMTM5NzYsImV4cCI6MTc1NjMxNDg3NiwiYXVkIjoicmVhbHRpbWUtc2Vzc2lvbiIsImlzcyI6ImFpVm9pY2VBZ2VudCJ9.xaH7RvqdekrpLkDB7354Y8Ri7TjYyXIzrrybuhVT-Ys'
}
ğŸ’“ Processing heartbeat for session: session_1756313976117_0vtj4dn5p incremental time: 4 seconds, total used: 14 seconds
ğŸ“ Updating active session: session_1756313976117_0vtj4dn5p with: { lastHeartbeat: '2025-08-27T16:59:53.495Z', quotaUsed: 14 }
âœ… Active session updated in database
ğŸ“ Updating active session: session_1756313976117_0vtj4dn5p with: { lastHeartbeat: '2025-08-27T16:59:53.509Z', quotaUsed: 14 }
âœ… Active session updated in database
ğŸ’¾ Updating user usage: {
  userId: 'user1',
  month: '2025-08',
  totalSeconds: 0,
  sessionsCount: 0,
  lastReset: '2025-08-27T16:55:33.499Z',
  sessionTimeRemaining: 870
}
âœ… User usage updated in database
ğŸ’¾ Updating user usage: {
  userId: 'user1',
  month: '2025-08',
  totalSeconds: 0,
  sessionsCount: 0,
  lastReset: '2025-08-27T16:55:33.499Z',
  sessionTimeRemaining: 870
}
âœ… User usage updated in database
ğŸ”” Client heartbeat received: {
  timestamp: 1756313998222,
  sessionToken: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiJ1c2VyMSIsInNlc3Npb25JZCI6InNlc3Npb25fMTc1NjMxMzk3NjExN18wdnRqNGRuNXAiLCJxdW90YVNlY29uZHMiOjkwMCwiaXNzdWVkQXQiOjE3NTYzMTM5NzYxMTcsImV4cGlyZXNBdCI6MTc1NjMxNDg3NjExNywiaXBBZGRyZXNzIjoiOjpmZmZmOjEyNy4wLjAuMSIsIm5vbmNlIjoiNmNlY2M5MDZkYTRjNWMwZjU5OTE5NjU4OTliYThlZjYiLCJpYXQiOjE3NTYzMTM5NzYsImV4cCI6MTc1NjMxNDg3NiwiYXVkIjoicmVhbHRpbWUtc2Vzc2lvbiIsImlzcyI6ImFpVm9pY2VBZ2VudCJ9.xaH7RvqdekrpLkDB7354Y8Ri7TjYyXIzrrybuhVT-Ys'
}
ğŸ’“ Processing heartbeat for session: session_1756313976117_0vtj4dn5p incremental time: 4 seconds, total used: 18 seconds
ğŸ“ Updating active session: session_1756313976117_0vtj4dn5p with: { lastHeartbeat: '2025-08-27T16:59:58.391Z', quotaUsed: 18 }
âœ… Active session updated in database
ğŸ“ Updating active session: session_1756313976117_0vtj4dn5p with: { lastHeartbeat: '2025-08-27T16:59:58.405Z', quotaUsed: 18 }
âœ… Active session updated in database
ğŸ’¾ Updating user usage: {
  userId: 'user1',
  month: '2025-08',
  totalSeconds: 0,
  sessionsCount: 0,
  lastReset: '2025-08-27T16:55:33.499Z',
  sessionTimeRemaining: 852
}
âœ… User usage updated in database
ğŸ’¾ Updating user usage: {
  userId: 'user1',
  month: '2025-08',
  totalSeconds: 0,
  sessionsCount: 0,
  lastReset: '2025-08-27T16:55:33.499Z',
  sessionTimeRemaining: 852
}
âœ… User usage updated in database
ğŸ”” Client heartbeat received: {
  timestamp: 1756314003221,
  sessionToken: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiJ1c2VyMSIsInNlc3Npb25JZCI6InNlc3Npb25fMTc1NjMxMzk3NjExN18wdnRqNGRuNXAiLCJxdW90YVNlY29uZHMiOjkwMCwiaXNzdWVkQXQiOjE3NTYzMTM5NzYxMTcsImV4cGlyZXNBdCI6MTc1NjMxNDg3NjExNywiaXBBZGRyZXNzIjoiOjpmZmZmOjEyNy4wLjAuMSIsIm5vbmNlIjoiNmNlY2M5MDZkYTRjNWMwZjU5OTE5NjU4OTliYThlZjYiLCJpYXQiOjE3NTYzMTM5NzYsImV4cCI6MTc1NjMxNDg3NiwiYXVkIjoicmVhbHRpbWUtc2Vzc2lvbiIsImlzcyI6ImFpVm9pY2VBZ2VudCJ9.xaH7RvqdekrpLkDB7354Y8Ri7TjYyXIzrrybuhVT-Ys'
}
ğŸ’“ Processing heartbeat for session: session_1756313976117_0vtj4dn5p incremental time: 4 seconds, total used: 22 seconds
ğŸ“ Updating active session: session_1756313976117_0vtj4dn5p with: { lastHeartbeat: '2025-08-27T17:00:03.279Z', quotaUsed: 22 }
âœ… Active session updated in database
ğŸ“ Updating active session: session_1756313976117_0vtj4dn5p with: { lastHeartbeat: '2025-08-27T17:00:03.293Z', quotaUsed: 22 }
âœ… Active session updated in database
ğŸ’¾ Updating user usage: {
  userId: 'user1',
  month: '2025-08',
  totalSeconds: 0,
  sessionsCount: 0,
  lastReset: '2025-08-27T16:55:33.499Z',
  sessionTimeRemaining: 830
}
âœ… User usage updated in database
ğŸ’¾ Updating user usage: {
  userId: 'user1',
  month: '2025-08',
  totalSeconds: 0,
  sessionsCount: 0,
  lastReset: '2025-08-27T16:55:33.499Z',
  sessionTimeRemaining: 830
}
âœ… User usage updated in database
ğŸ”” Client heartbeat received: {
  timestamp: 1756314008220,
  sessionToken: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiJ1c2VyMSIsInNlc3Npb25JZCI6InNlc3Npb25fMTc1NjMxMzk3NjExN18wdnRqNGRuNXAiLCJxdW90YVNlY29uZHMiOjkwMCwiaXNzdWVkQXQiOjE3NTYzMTM5NzYxMTcsImV4cGlyZXNBdCI6MTc1NjMxNDg3NjExNywiaXBBZGRyZXNzIjoiOjpmZmZmOjEyNy4wLjAuMSIsIm5vbmNlIjoiNmNlY2M5MDZkYTRjNWMwZjU5OTE5NjU4OTliYThlZjYiLCJpYXQiOjE3NTYzMTM5NzYsImV4cCI6MTc1NjMxNDg3NiwiYXVkIjoicmVhbHRpbWUtc2Vzc2lvbiIsImlzcyI6ImFpVm9pY2VBZ2VudCJ9.xaH7RvqdekrpLkDB7354Y8Ri7TjYyXIzrrybuhVT-Ys'
}
ğŸ’“ Processing heartbeat for session: session_1756313976117_0vtj4dn5p incremental time: 4 seconds, total used: 26 seconds
ğŸ“ Updating active session: session_1756313976117_0vtj4dn5p with: { lastHeartbeat: '2025-08-27T17:00:08.169Z', quotaUsed: 26 }
âœ… Active session updated in database
ğŸ“ Updating active session: session_1756313976117_0vtj4dn5p with: { lastHeartbeat: '2025-08-27T17:00:08.183Z', quotaUsed: 26 }
âœ… Active session updated in database
ğŸ’¾ Updating user usage: {
  userId: 'user1',
  month: '2025-08',
  totalSeconds: 0,
  sessionsCount: 0,
  lastReset: '2025-08-27T16:55:33.499Z',
  sessionTimeRemaining: 804
}
âœ… User usage updated in database
ğŸ’¾ Updating user usage: {
  userId: 'user1',
  month: '2025-08',
  totalSeconds: 0,
  sessionsCount: 0,
  lastReset: '2025-08-27T16:55:33.499Z',
  sessionTimeRemaining: 804
}
âœ… User usage updated in database
Tool usage: POST /tools/assess_user_mood - Session: session_1756313976117_0vtj4dn5p - User: user1
ğŸ§  Mood assessment tool called: {
  userId: 'user1',
  userResponse: 'Yeah... no, actually not at all.',
  sessionId: 'session-1756314009511-user1'
}
ğŸ§  AI Assessing mood for user user1: "Yeah... no, actually not at all...."
ğŸ“ Session updated for user1 with mood: frustrated
âœ… AI Mood assessed: frustrated (confidence: 0.80) - The use of 'Yeah... no' suggests a conflicted or dismissive attitude, indicating irritation or frustration. The phrase 'actually not at all' reinforces a sense of rejection or disappointment, implying that the user is not satisfied with the situation.
âœ… Mood assessed: frustrated | Confidence: 0.80
